(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[52],{"72k+":function(e,t,a){"use strict";var r=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("Pwec");var n=r(a("CtXQ"));a("5Dmo");var u=r(a("3S7+"));a("jCWc");var s=r(a("kPKH"));a("14J3");var d=r(a("BMrR")),l=r(a("qIgq")),i=p(a("q1tI")),o=a("Y2fQ"),c=p(a("vTut")),m=r(a("ZhIB")),f=r(a("hTBk")),g=r(a("CLrh")),v=r(a("wd/R")),y=a("N8P2");function b(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(b=function(e){return e?a:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=b(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var s=n?Object.getOwnPropertyDescriptor(e,u):null;s&&(s.get||s.set)?Object.defineProperty(r,u,s):r[u]=e[u]}return r.default=e,a&&a.set(e,r),r}var h=c.default.ChartCard,M=c.default.MiniArea,E=c.default.MiniBar,D=c.default.Field,j={xs:24,sm:12,md:12,lg:12,xl:6,style:{marginBottom:24}},k=function(e){var t=e.loading,a=e.visitData,r={cpu:0,memoryMax:0,memoryUsed:0,messageData:[],sameDay:0,month:0,metadata:{},eventData:[]},b=(0,i.useState)(r.cpu),p=(0,l.default)(b,2),k=p[0],w=p[1],O=(0,i.useState)(r.memoryMax),S=(0,l.default)(O,2),Y=S[0],C=S[1],P=(0,i.useState)(r.memoryUsed),x=(0,l.default)(P,2),q=x[0],T=x[1],F=(0,i.useState)(r.sameDay),N=(0,l.default)(F,2),W=N[0],B=N[1],H=(0,i.useState)(r.month),I=(0,l.default)(H,2),L=I[0],A=I[1],J=(0,i.useState)(r.month),_=(0,l.default)(J,2),Q=_[0],R=_[1],U=(0,i.useState)(r.month),X=(0,l.default)(U,2),G=X[0],K=X[1],V=(0,i.useState)(r.month),Z=(0,l.default)(V,2),z=Z[0],$=Z[1],ee=(0,i.useState)(r.messageData),te=(0,l.default)(ee,1),ae=te[0],re=function(){var e=new Date;e.setDate(e.getDate()-30);var t=e.getFullYear(),a=e.getMonth()+1<10?"0".concat(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0".concat(e.getDate()):e.getDate();return"".concat(t,"-").concat(a,"-").concat(r," 00:00:00")},ne=function(){var e=[{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"sameDay",params:{time:"1d",format:"yyyy-MM-dd"}},{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"sameMonth",params:{limit:30,time:"1d",format:"yyyy-MM-dd",from:re()}},{dashboard:"device",object:"message",measurement:"quantity",dimension:"agg",group:"month",params:{time:"1M",format:"yyyy-MM-dd",from:re()}}];g.default.analysis.getMulti(e).then(function(e){var t=null===e||void 0===e?void 0:e.result;200===e.status&&t.forEach(function(e){switch(e.group){case"sameDay":B(e.data.value);break;case"month":A(e.data.value);break;case"sameMonth":ae.push({x:(0,v.default)(new Date(e.data.timeString)).format("YYYY-MM-DD"),y:Number(e.data.value)});break;default:break}})})},ue=function(){var e=[{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceOnline",params:{state:"online"}},{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceCount"},{dashboard:"device",object:"status",measurement:"record",dimension:"current",group:"deviceNotActive",params:{state:"notActive"}},{dashboard:"device",object:"status",measurement:"record",dimension:"aggOnline",group:"aggOnline",params:{limit:20,time:"1d",format:"yyyy-MM-dd"}}];g.default.analysis.getMulti(e).then(function(e){var t=null===e||void 0===e?void 0:e.result;200===e.status&&t.forEach(function(e){switch(e.group){case"aggOnline":a.push({x:(0,v.default)(new Date(e.data.timeString)).format("YYYY-MM-DD"),y:Number(e.data.value)});break;case"deviceOnline":R(e.data.value);break;case"deviceCount":K(e.data.value);break;case"notActive":$(e.data.value);break;default:break}})})},se=(0,i.useState)(),de=(0,l.default)(se,2),le=de[0],ie=de[1],oe=(0,i.useState)(),ce=(0,l.default)(oe,2),me=ce[0],fe=ce[1];return(0,i.useEffect)(function(){ue(),ne();var e=(0,y.getWebsocket)("home-page-statistics-cpu-realTime","/dashboard/systemMonitor/cpu/usage/realTime",{params:{history:1}}).subscribe(function(e){var t=e.payload;if("home-page-statistics-cpu-realTime"===e.requestId){var a=t.value;w(a)}}),t=(0,y.getWebsocket)("home-page-statistics-jvm-realTime","/dashboard/jvmMonitor/memory/info/realTime",{params:{history:1}}).subscribe(function(e){var t=e.payload;if("home-page-statistics-jvm-realTime"===e.requestId){var a=t.value;C(a.max),T(a.used)}});return fe(t),ie(e),function(){le&&le.unsubscribe(),me&&me.unsubscribe()}},[]),i.default.createElement(d.default,{gutter:24},i.default.createElement(s.default,Object.assign({},j),i.default.createElement(h,{loading:t,bordered:!1,title:"\u5f53\u524d\u5728\u7ebf",action:i.default.createElement(u.default,{title:"\u5237\u65b0"},i.default.createElement(n.default,{type:"sync",onClick:function(){ue()}})),total:(0,m.default)(Q).format("0,0"),footer:i.default.createElement("div",{style:{whiteSpace:"nowrap",overflow:"hidden"}},i.default.createElement(D,{style:{marginRight:80,float:"left"},label:i.default.createElement(o.FormattedMessage,{id:"analysis.analysis.device-total",defaultMessage:"\u8bbe\u5907\u603b\u91cf"}),value:(0,m.default)(G).format("0,0")}),i.default.createElement(D,{label:i.default.createElement(o.FormattedMessage,{id:"analysis.analysis.device-activation",defaultMessage:"\u672a\u6fc0\u6d3b\u8bbe\u5907"}),value:(0,m.default)(z).format("0,0")})),contentHeight:46},i.default.createElement(E,{data:a}))),i.default.createElement(s.default,Object.assign({},j),i.default.createElement(h,{bordered:!1,loading:t,title:i.default.createElement(o.FormattedMessage,{id:"analysis.analysis.device-day-visits",defaultMessage:"\u65e5\u8bbf\u6d88\u606f\u91cf"}),action:i.default.createElement(u.default,{title:"\u5237\u65b0"},i.default.createElement(n.default,{type:"sync",onClick:function(){ne()}})),total:(0,m.default)(W).format("0,0"),footer:i.default.createElement(D,{label:i.default.createElement(o.FormattedMessage,{id:"analysis.analysis.device-visits",defaultMessage:"\u5f53\u6708\u8bbe\u5907\u6d88\u606f\u91cf"}),value:(0,m.default)(L).format("0,0")}),contentHeight:46},i.default.createElement(M,{color:"#975FE4",data:ae}))),i.default.createElement(s.default,Object.assign({},j),i.default.createElement(h,{loading:t,bordered:!1,title:"CPU\u4f7f\u7528\u7387",contentHeight:120},i.default.createElement(f.default,{height:169,percent:k}))),i.default.createElement(s.default,Object.assign({},j),i.default.createElement(h,{loading:t,bordered:!1,title:"JVM\u5185\u5b58",contentHeight:120},i.default.createElement(c.Gauge,{height:169,percent:q,memoryMax:Y}))))},w=k;t.default=w},Y2fQ:function(e,t,a){e.exports=a("LLXN").default||a("LLXN")}}]);